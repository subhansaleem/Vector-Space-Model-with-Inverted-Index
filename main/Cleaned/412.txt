automated behavioral analysis malware case study wannacry ransomware malware feature extraction encryption robustness tool data mining ransomware class self propagating malware that us encryption hold victim data ransom emerged recent year one most dangerous cyber threat with widespread damage e g zero day ransomware wannacry caused world wide catastrophe from knocking u k national health service hospital offline shutting down honda motor company japan 1 our close collaboration with security operation large enterprise reveals that defense against ransomware relies tedious analysis from high volume system log first few infection sandbox analysis freshly captured malware also commonplace operation introduce method identify rank most discriminating ransomware feature from set ambient non attack system log least one log stream containing both ambient ransomware behavior these ranked feature reveal set malware action that produced automatically from system log help automate tedious manual analysis test our approach using wannacry two polymorphic sample by producing log with cuckoo sandbox during both ambient ambient plus ransomware execution our goal extract feature malware from log with only knowledge that malware wa present compare output with detailed analysis wannacry allowing validation algorithm s feature extraction provide analysis method s robustness variation input data changing quality quantity ambient data testing polymorphic ransomware most notably our pattern accurate unwavering when generated from polymorphic wannacry copy which 63 63 tested antivirus av product fail 